<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Player Management Test - All 10 Players</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .controls { background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .test-grid { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 15px; 
            min-height: 500px;
            background: white;
            padding: 20px;
            border-radius: 8px;
        }
        .player-column { 
            border: 2px solid #ccc; 
            padding: 15px; 
            text-align: center; 
            border-radius: 8px;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            transition: opacity 0.3s;
        }
        .base-player { border-color: #2196F3; background: #E3F2FD; }
        .extra-player { border-color: orange; color: white; }
        .center-column { border-color: #4CAF50; background: #E8F5E8; }
        .removed { opacity: 0.3; filter: grayscale(100%); }
        button { padding: 10px 15px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; }
        .remove-btn { background: #ff4444; color: white; }
        .add-btn { background: #44aa44; color: white; }
        .remove-btn:disabled, .add-btn:disabled { background: #ccc; cursor: not-allowed; }
        .status { margin: 10px 0; font-weight: bold; }
        .player-info { font-size: 0.9em; color: #666; margin-top: 5px; }
        .demo-buttons { margin-top: 15px; }
        .demo-buttons button { background: #2196F3; color: white; margin: 2px; font-size: 0.85em; padding: 6px 10px; }
        .feature-highlight { background: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; border-radius: 6px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>ðŸŽ® Complete Player Management Test - All 10 Players</h1>
    
    <div class="feature-highlight">
        <strong>ðŸ†• NEW FEATURES:</strong> You can now add/remove ALL players including Player 1 & Player 2! Minimum is just 1 player total.
    </div>
    
    <div class="controls">
        <div>
            <button id="add-player" class="add-btn">Add Player</button>
            <button id="remove-player" class="remove-btn">Remove Player</button>
            <span id="player-count" class="status">Players: 2</span>
        </div>
        
        <div class="demo-buttons">
            <strong>Quick Tests:</strong><br>
            <button onclick="removePlayer('left')">Remove Player 1</button>
            <button onclick="removePlayer('right')">Remove Player 2</button>
            <button onclick="addPlayer('left')">Re-add Player 1</button>
            <button onclick="addPlayer('right')">Re-add Player 2</button>
            <br>
            <button onclick="addPlayers(['extra1','extra3','extra5'])">Add P3,P5,P7</button>
            <button onclick="removePlayer('extra3')">Remove P5</button>
            <button onclick="removeAllPlayers()">Remove All But One</button>
            <button onclick="resetAll()">Reset All</button>
        </div>
    </div>
    
    <div class="test-grid" id="player-grid">
        <div class="player-column base-player" id="column-left" style="grid-column: 1; grid-row: 1; background: #2196F3; color: white;">
            <h3>Player 1</h3>
            <div class="player-info" style="color: #E3F2FD;">Base player - can be removed now!</div>
        </div>
        <div class="player-column center-column" style="grid-column: 2; grid-row: 1;">
            <h3>Unassigned Chores</h3>
            <div class="player-info">Center column - Dynamic spanning</div>
        </div>
        <div class="player-column base-player" id="column-right" style="grid-column: 3; grid-row: 1; background: #E53E3E; color: white;">
            <h3>Player 2</h3>
            <div class="player-info" style="color: #FFE3E3;">Base player - can be removed now!</div>
        </div>
    </div>
    
    <div style="margin-top: 20px; background: white; padding: 15px; border-radius: 8px;">
        <h3>ðŸŽ¯ New Player Management Features:</h3>
        <ul>
            <li><strong>Remove Any Player:</strong> Now includes Player 1 and Player 2 - they're no longer "untouchable"</li>
            <li><strong>Minimum 1 Player:</strong> You can remove players down to just 1 remaining (previously required 2)</li>
            <li><strong>Smart Re-adding:</strong> Add button shows all available players (removed base players + unused extra slots)</li>
            <li><strong>Visual Feedback:</strong> Removed base players become hidden, extra players are completely removed</li>
            <li><strong>Gap-Free Layout:</strong> All positioning is automatically optimized regardless of which players are active</li>
        </ul>
        
        <h3>ðŸ§ª Test Scenarios:</h3>
        <ul>
            <li>Remove Player 1 â†’ Add button shows it as available to re-add</li>
            <li>Remove Player 2 â†’ Same smart re-adding for base players</li>
            <li>Remove all but one player â†’ Remove button becomes disabled</li>
            <li>Mix of base and extra players â†’ Perfect gap-free positioning</li>
        </ul>
    </div>
    
    <script>
        // Enhanced test implementation with base player support
        let extraPlayers = {};
        let basePlayers = { left: true, right: true };
        
        const playerColors = {
            left: '#2196F3', right: '#E53E3E',
            extra1: 'orange', extra2: 'limegreen', extra3: 'purple', extra4: 'yellow',
            extra5: 'pink', extra6: 'brown', extra7: 'gray', extra8: 'teal'
        };
        const playerNames = {
            left: 'Player 1', right: 'Player 2',
            extra1: 'Player 3', extra2: 'Player 4', extra3: 'Player 5', extra4: 'Player 6',
            extra5: 'Player 7', extra6: 'Player 8', extra7: 'Player 9', extra8: 'Player 10'
        };
        
        function getActivePlayers() {
            const players = [];
            if(basePlayers.left) players.push({ loc: 'left', name: playerNames.left, isBase: true });
            if(basePlayers.right) players.push({ loc: 'right', name: playerNames.right, isBase: true });
            
            for(let i = 1; i <= 8; i++) {
                const extraKey = `extra${i}`;
                if(extraPlayers[extraKey]) {
                    players.push({ loc: extraKey, name: playerNames[extraKey], isBase: false });
                }
            }
            return players;
        }
        
        function getAvailablePlayersToAdd() {
            const available = [];
            if(!basePlayers.left) available.push({ loc: 'left', name: playerNames.left, isBase: true });
            if(!basePlayers.right) available.push({ loc: 'right', name: playerNames.right, isBase: true });
            
            for(let i = 1; i <= 8; i++) {
                const extraKey = `extra${i}`;
                if(!extraPlayers[extraKey]) {
                    available.push({ loc: extraKey, name: playerNames[extraKey], isBase: false });
                }
            }
            return available;
        }
        
        function updateButtons() {
            const totalPlayers = getActivePlayers().length;
            const availableToAdd = getAvailablePlayersToAdd().length;
            
            document.getElementById('add-player').disabled = availableToAdd === 0;
            document.getElementById('remove-player').disabled = totalPlayers <= 1;
            document.getElementById('player-count').textContent = `Players: ${totalPlayers}`;
        }
        
        function repositionColumns() {
            const activeExtras = [];
            for(let i = 1; i <= 8; i++) {
                const extraKey = `extra${i}`;
                if(extraPlayers[extraKey]) {
                    activeExtras.push({ key: extraKey, number: i, isLeft: i % 2 === 1 });
                }
            }
            
            const leftPlayers = activeExtras.filter(p => p.isLeft).sort((a, b) => a.number - b.number);
            const rightPlayers = activeExtras.filter(p => !p.isLeft).sort((a, b) => a.number - b.number);
            
            leftPlayers.forEach((player, index) => {
                const column = document.getElementById(`column-${player.key}`);
                if(column) {
                    column.style.gridColumn = '1';
                    column.style.gridRow = (index + 2).toString();
                }
            });
            
            rightPlayers.forEach((player, index) => {
                const column = document.getElementById(`column-${player.key}`);
                if(column) {
                    column.style.gridColumn = '3';
                    column.style.gridRow = (index + 2).toString();
                }
            });
            
            // Update center column span
            const centerColumn = document.querySelector('.center-column');
            const maxRowsNeeded = Math.max(leftPlayers.length, rightPlayers.length) + 1;
            centerColumn.style.gridRow = activeExtras.length === 0 ? '1' : `1 / ${maxRowsNeeded + 1}`;
        }
        
        function addPlayer(specificPlayer = null) {
            if(specificPlayer) {
                if(specificPlayer === 'left' || specificPlayer === 'right') {
                    basePlayers[specificPlayer] = true;
                    const column = document.getElementById(`column-${specificPlayer}`);
                    if(column) {
                        column.style.display = '';
                        column.classList.remove('removed');
                    }
                } else {
                    extraPlayers[specificPlayer] = true;
                    createExtraColumn(specificPlayer);
                }
            } else {
                const available = getAvailablePlayersToAdd();
                if(available.length === 0) return;
                
                // Simple selection for demo
                const choice = available[0];
                addPlayer(choice.loc);
            }
            
            repositionColumns();
            updateButtons();
        }
        
        function removePlayer(specificPlayer = null) {
            let playerToRemove = specificPlayer;
            
            if(!playerToRemove) {
                const activePlayers = getActivePlayers();
                if(activePlayers.length <= 1) return;
                
                // Simple selection for demo
                const playerList = activePlayers.map(p => `${p.loc}: ${p.name}`).join('\n');
                playerToRemove = prompt(`Choose player to remove:\n${playerList}\n\nEnter player key (e.g., left, right, extra1):`);
            }
            
            if(playerToRemove && (basePlayers[playerToRemove] || extraPlayers[playerToRemove])) {
                if(playerToRemove === 'left' || playerToRemove === 'right') {
                    basePlayers[playerToRemove] = false;
                    const column = document.getElementById(`column-${playerToRemove}`);
                    if(column) {
                        column.style.display = 'none';
                        column.classList.add('removed');
                    }
                } else {
                    extraPlayers[playerToRemove] = false;
                    const column = document.getElementById(`column-${playerToRemove}`);
                    if(column) column.remove();
                }
                
                repositionColumns();
                updateButtons();
            }
        }
        
        function createExtraColumn(extraKey) {
            const grid = document.getElementById('player-grid');
            const newColumn = document.createElement('div');
            newColumn.className = 'player-column extra-player';
            newColumn.id = `column-${extraKey}`;
            newColumn.style.backgroundColor = playerColors[extraKey];
            newColumn.style.color = playerColors[extraKey] === 'yellow' ? 'black' : 'white';
            
            const slotNumber = parseInt(extraKey.replace('extra', ''));
            const isLeft = slotNumber % 2 === 1;
            newColumn.style.gridColumn = isLeft ? '1' : '3';
            newColumn.style.gridRow = '2';
            
            newColumn.innerHTML = `
                <h3>${playerNames[extraKey]}</h3>
                <div class="player-info" style="color: ${playerColors[extraKey] === 'yellow' ? '#666' : '#ddd'};">
                    Slot ${slotNumber} - ${isLeft ? 'Left' : 'Right'} Side
                </div>
            `;
            
            grid.appendChild(newColumn);
        }
        
        function addPlayers(playerLocs) {
            playerLocs.forEach(loc => addPlayer(loc));
        }
        
        function removeAllPlayers() {
            const activePlayers = getActivePlayers();
            // Remove all but the first one
            for(let i = 1; i < activePlayers.length; i++) {
                removePlayer(activePlayers[i].loc);
            }
        }
        
        function resetAll() {
            // Reset to initial state: just Player 1 and Player 2
            Object.keys(extraPlayers).forEach(key => {
                extraPlayers[key] = false;
                const column = document.getElementById(`column-${key}`);
                if(column) column.remove();
            });
            
            basePlayers.left = true;
            basePlayers.right = true;
            const leftCol = document.getElementById('column-left');
            const rightCol = document.getElementById('column-right');
            if(leftCol) {
                leftCol.style.display = '';
                leftCol.classList.remove('removed');
            }
            if(rightCol) {
                rightCol.style.display = '';
                rightCol.classList.remove('removed');
            }
            
            repositionColumns();
            updateButtons();
        }
        
        document.getElementById('add-player').addEventListener('click', () => addPlayer());
        document.getElementById('remove-player').addEventListener('click', () => removePlayer());
        
        updateButtons();
    </script>
</body>
</html>